---
title: "Presence of persons in naturalistic scenes and consequences - A conceptual replication"
subtitle: "SFB-Meeting"
author: "Jonas Großekathöfer, Kristina Suchotzki & Matthias Gamer"
date: "2017/11/13"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r load_packages, include = FALSE}

library("papaja")
library("tidyverse")
library("car")
library("afex")
library("ggpubr")
library("ggpubr")

```

```{r paths, include=FALSE}

rm(list=ls())

pathMEM <- "../01_data/Memory/"
pathET <- "../01_data/prot/"
pathFB <- "../01_data/FB/"

```

```{r Reading eye tracking data in, warning = FALSE, message = FALSE, include=FALSE}

# ALL EYE TRACKING DATA
vpn <- paste0("vpja",ifelse(c(1:78,81:96)<10,"0",""),c(1:78,81:96))
bed <- rep(c("free","mem"),47)

# ORIGINALLY ACQUIRED DATA
#vpn <- paste0("vpja",ifelse(c(1:78)<10,"0",""),c(1:78))
#bed <- rep(c("free","mem"),39)

bed <- bed[!(vpn %in% "vpja23")]  # missing data
vpn <- vpn[!(vpn %in% "vpja23")]  

# Loop over subjects
erg <- numeric(); nvalid <- numeric(); cleantime <- numeric()
for (vp in vpn) {
  #  print(vp)

  prot <- read.csv2(paste0(pathET,vp,"_Fixations.csv"))

  # Restrict to trials with valid baseline?
  nvalid <- c(nvalid,sum(prot$blok==1))
  prot <- prot[prot$blok==1,]

  cleantime <- c(cleantime,mean(prot$cleantime))

  erg <- rbind(erg,apply(prot[,8:ncol(prot)],2,mean,na.rm=TRUE))
}

df.w.et <- data.frame(code=vpn,group=bed,nvalid,cleantime,erg)


df.l.et <- gather(df.w.et, key, value, fix.face:sac.bnongaze, factor_key=TRUE) %>%
  mutate(
    key = as.character(key),
    fixations =
      as.factor(
        ifelse(startsWith(key, "fix."), "fix",
             ifelse(startsWith(key, "fixn."), "fixn",
                    ifelse(startsWith(key, "fixlat."), "fixlat",
                           ifelse(startsWith(key, "sac."), "sac", NA))))),
    region =
      as.factor(
        ifelse(endsWith(key, ".face"), "face",
               ifelse(endsWith(key, ".body"), "body",
                      ifelse(endsWith(key, ".gaze"), "gaze",
                             ifelse(endsWith(key, ".nongaze"), "nongaze",
                                    ifelse(endsWith(key, ".pgaze"), "pgaze",
                                           ifelse(endsWith(key, ".fgaze"), "fgaze",
                                                  ifelse(endsWith(key, ".bgaze"), "bgaze",
                                                         ifelse(endsWith(key, ".pnongaze"), "pnongaze",
                                                                ifelse(endsWith(key, ".fnongaze"), "fnongaze",
                                                                       ifelse(endsWith(key, ".bnongaze"), "bnongaze",NA)))))))))))) %>%
  arrange(code)

rm(prot, bed, cleantime, nvalid, vp, vpn, erg)

```

```{r Reading memory data in, warning = FALSE, message = FALSE, include=FALSE}

# ALL MEMORY DATA
vpn <- paste0("vpja",ifelse(c(1:78,81:96)<10,"0",""),c(1:78,81:96))
bed <- rep(c("free","mem"),47)

# ORIGINALLY ACQUIRED DATA
#vpn <- pasteo("vpja",ifelse(c(1:78)<10,"0",""),c(1:78))
#bed <- rep(c("free","mem"),39)

# Loop over subjects
erg <- numeric()
for (vp in vpn) {
  # print(vp)

  prot <- read.csv2(paste0(pathMEM,vp,".csv"))

  # Item recalled
  gaze <- sum(prot$memgazedat)
  nogaze <- sum(prot$memnongazedat)

  erg <- rbind(erg,c(gaze,nogaze))
}

df.w.mem <- data.frame(code=vpn,bed,erg)               
names(df.w.mem) <- c("code","bed","memgaze","memnogaze")

rm(gaze, nogaze, erg, prot, bed, vp, vpn)

```

```{r Reading questionnaire data in, warning = FALSE, message = FALSE, include=FALSE}

df.w.demo <- read_csv2(paste0(pathFB,"Projektarbeit_Dateneingabemaske.csv")) %>%
  transmute(
    vp = as.factor(VP_Nr),
    sex = as.factor(Demo_Sex),
    age = Demo_Alter,
    aq_social = ifelse((5-AQK_1) < 3, 1, 0) + ifelse((5-AQK_7) < 3, 1, 0) + ifelse(AQK_8 < 3, 1, 0) + ifelse((5-AQK_10) < 3, 1, 0) + ifelse((5-AQK_11) < 3, 1, 0) + ifelse(AQK_13 < 3, 1, 0) + ifelse((5-AQK_14) < 3, 1, 0) + ifelse((5-AQK_20) < 3, 1, 0) + ifelse((5-AQK_24) < 3, 1, 0) + ifelse((5-AQK_28) < 3, 1, 0) + ifelse((5-AQK_31) < 3, 1, 0), # 5- 'item' for reversed items, then if 1/2 -> 1, 3/4 -> 0  
    aq_imagination = ifelse((5-AQK_3) < 3, 1, 0) + ifelse((5-AQK_5) < 3, 1, 0) + ifelse((5-AQK_6) < 3, 1, 0) + ifelse((5-AQK_9) < 3, 1, 0) + ifelse((5-AQK_16) < 3, 1, 0) + ifelse((5-AQK_17) < 3, 1, 0) + ifelse((5-AQK_18) < 3, 1, 0) + ifelse((5-AQK_22) < 3, 1, 0) + ifelse((5-AQK_23) < 3, 1, 0) + ifelse((5-AQK_26) < 3, 1, 0) + ifelse((5-AQK_32) < 3, 1, 0) + ifelse((5-AQK_33) < 3, 1, 0),
    aq_communication = ifelse(AQK_2 < 3, 1, 0) + ifelse(AQK_4 < 3, 1, 0) + ifelse(AQK_12 < 3, 1, 0) + ifelse(AQK_15 < 3, 1, 0) + ifelse(AQK_19 < 3, 1, 0) + ifelse(AQK_21 < 3, 1, 0) + ifelse(AQK_25 < 3, 1, 0) + ifelse(AQK_27 < 3, 1, 0) + ifelse(AQK_29 < 3, 1, 0) + ifelse(AQK_30 < 3, 1, 0),
    aq_sumscore = ifelse((5-AQK_1) < 3, 1, 0) + ifelse(AQK_2 < 3, 1, 0) + ifelse((5-AQK_3) < 3, 1, 0) + ifelse(AQK_4 < 3, 1, 0) + ifelse((5-AQK_5) < 3, 1, 0) + ifelse((5-AQK_6) < 3, 1, 0) + ifelse((5-AQK_7) < 3, 1, 0) + ifelse(AQK_8 < 3, 1, 0) + ifelse((5-AQK_9) < 3, 1, 0) + ifelse((5-AQK_10) < 3, 1, 0) + ifelse((5-AQK_11) < 3, 1, 0) + ifelse(AQK_12 < 3, 1, 0) + ifelse(AQK_13 < 3, 1, 0) + ifelse((5-AQK_14) < 3, 1, 0) + ifelse(AQK_15 < 3, 1, 0) + ifelse((5-AQK_16) < 3, 1, 0) + ifelse((5-AQK_17) < 3, 1, 0) + ifelse((5-AQK_18) < 3, 1, 0) + ifelse(AQK_19 < 3, 1, 0) + ifelse((5-AQK_20) < 3, 1, 0) + ifelse(AQK_21 < 3, 1, 0) + ifelse((5-AQK_22) < 3, 1, 0) + ifelse((5-AQK_23) < 3, 1, 0) + ifelse((5-AQK_24) < 3, 1, 0) + ifelse(AQK_25 < 3, 1, 0) + ifelse((5-AQK_26) < 3, 1, 0) + ifelse(AQK_27 < 3, 1, 0) + ifelse((5-AQK_28) < 3, 1, 0) + ifelse(AQK_29 < 3, 1, 0) + ifelse(AQK_30 < 3, 1, 0) + ifelse((5-AQK_31) < 3, 1, 0) + ifelse((5-AQK_32) < 3, 1, 0) + ifelse((5-AQK_33) < 3, 1, 0))

```

```{r TO-DO: Plots fixations joint, warining = FALSE, message = FALSE, include=FALSE}

```

```{r Descriptives fixations joint, warining = FALSE, message = FALSE, include=FALSE}

# Descriptives for fixation chacracteristics for joint attention

dscr.fixjoi <- df.w.et %>% summarise(mean(fix.gaze), sd(fix.gaze), mean(fix.nongaze), sd(fix.nongaze), mean(fixn.gaze), sd(fixn.gaze), mean(fixn.nongaze), sd(fixn.nongaze), mean(fixlat.gaze), mean(fixlat.nongaze), sd(fixlat.nongaze))
dscr.fixjoi.group <- df.w.et %>% group_by(group) %>% summarise(mean(fix.gaze), sd(fix.gaze), mean(fix.nongaze), sd(fix.nongaze), mean(fixn.gaze), sd(fixn.gaze), mean(fixn.nongaze), sd(fixn.nongaze), mean(fixlat.gaze), sd(fixlat.gaze), mean(fixlat.nongaze), sd(fixlat.nongaze))

```

```{r descriptives saccade, include=FALSE}
# dscr.sac <- df.w.et %>% summarise(m_sac.pgaze = mean(sac.pgaze), sd_sac.pgaze = sd(sac.pgaze),
#                                   m_sac.pnongaze=mean(sac.pnongaze), sd_sac.pnongaze=sd(sac.pnongaze),
#                                   m_sac.fgaze=mean(sac.fgaze), sd_sac.fgaze=sd(sac.fgaze),
#                                   m_sac.fnongaze=mean(sac.fnongaze), sd_sac.fnongaze=sd(sac.fnongaze),
#                                   m_sac.bgaze=mean(sac.bgaze), sd_sac.bgaze=sd(sac.bgaze),
#                                   m_sac.bnongaze=mean(sac.bnongaze), sd_sac.bnongaze=sd(sac.bnongaze))

dscr.sac.rpl <- df.w.et %>%
  group_by(group) %>%
  summarise_at(vars(sac.pgaze:sac.bnongaze), funs(mean,sd,se=sd(.)/sqrt(n()))) %>% # mit den funs() die variablen vars(von:bis) berechnen
  gather(key, measure, sac.pgaze_mean:sac.bnongaze_se) %>% # ins longformat
  mutate(stat = as.factor(map(strsplit(key,"[[:punct:]]"), ~.x[3]) %>% unlist()),
         area = map(strsplit(key,"[[:punct:]]"), ~.x[2]) %>% unlist(),
         area = as.factor(substring(area,1,1)),
         gazed = map(strsplit(key,"[[:punct:]]"), ~.x[2]) %>% unlist(),
         gazed = as.factor(substring(gazed,2)),
         key = as.factor("replication")) %>% #rausnehmen, zur kontrolle, ob alles passt, was oben läuft.
  select(-measure, everything()) %>% # neusortieren der variablen
  select(key, everything())

dscr.sac.zwckl <- data.frame(key=c("zwickel","zwickel"),group=c("free", "free"),gazed=c("gaze", "gaze", "nongaze", "nongaze"),stat=c("mean", "se"),measure=c(.14,0.01,.09,0.01)) # free = person

```

```{r descriptives fix*, include=FALSE}
# dscr.sac <- df.w.et %>% summarise(m_sac.pgaze = mean(sac.pgaze), sd_sac.pgaze = sd(sac.pgaze),
#                                   m_sac.pnongaze=mean(sac.pnongaze), sd_sac.pnongaze=sd(sac.pnongaze),
#                                   m_sac.fgaze=mean(sac.fgaze), sd_sac.fgaze=sd(sac.fgaze),
#                                   m_sac.fnongaze=mean(sac.fnongaze), sd_sac.fnongaze=sd(sac.fnongaze),
#                                   m_sac.bgaze=mean(sac.bgaze), sd_sac.bgaze=sd(sac.bgaze),
#                                   m_sac.bnongaze=mean(sac.bnongaze), sd_sac.bnongaze=sd(sac.bnongaze))

dscr.fix.rpl <- df.w.et %>%
  group_by(group) %>%
  summarise_at(vars(fix.face:fixlat.nongaze), funs(mean,sd,se=sd(.)/sqrt(n()))) %>% # mit den funs() die variablen vars(von:bis) berechnen
  gather(key, measure, fix.face_mean:fixlat.nongaze_se) %>% # ins longformat
  mutate(fix = as.factor(map(strsplit(key,"[[:punct:]]"), ~.x[1]) %>% unlist()),
         gazed = map(strsplit(key,"[[:punct:]]"), ~.x[2]) %>% unlist(),
         gazed = as.factor(substring(gazed,1)),
         stat = as.factor(map(strsplit(key,"[[:punct:]]"), ~.x[3]) %>% unlist())) %>% 
  select(-measure, everything()) %>% # neusortieren der variablen
  select(key, everything())

dscr.fix.rpl$gazed <- factor(dscr.fix.rpl$gazed, levels=c("face", "body", "gaze", "nongaze"))

dscr.fix.zwckl <- data.frame(group="free",fix=c("fix","fix","fix","fix","fixn","fixn","fixn","fixn","fixlat","fixlat","fixlat","fixlat"), gazed=c("gaze","gaze", "nongaze", "nongaze"), stat=c("mean","se"), measure=c(0.08,.01,.07,.01,5.89,.37,5.24,.34,3588,133,4008,166)) # free = person

```
<!-- VERGLEICH -->

```{r plots saccade rpl-zwckl, include=FALSE}

plot.sac.rpl <- ggplot(subset(dscr.sac.rpl, stat == "mean" & area == "f" & group == "free"), aes(x= gazed, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.sac.rpl, stat == "mean" & area == "f" & group == "free")$measure - subset(dscr.sac.rpl, stat == "se" & area == "f" & group == "free")$measure,
    ymax=subset(dscr.sac.rpl, stat == "mean" & area == "f" & group == "free")$measure + subset(dscr.sac.rpl, stat == "se" & area == "f" & group == "free")$measure),
    width=.2,
    position=position_dodge(.9)) +
  expand_limits(y=c(0,0.15))

#plot.sac.rpl


plot.sac.zwckl <- ggplot(subset(dscr.sac.zwckl, stat == "mean"), aes(x = gazed, y=measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.sac.zwckl, stat == "mean")$measure - subset(dscr.sac.zwckl, stat == "se")$measure,
    ymax=subset(dscr.sac.zwckl, stat == "mean")$measure + subset(dscr.sac.zwckl, stat == "se")$measure),
    width=.2,
    position = position_dodge(.9))  +
  expand_limits(y=c(0,0.15))

 #plot.sac.zwckl

```

```{r plots fixlat rpl-zwckl, include=FALSE}

plot.fixlat.rpl <- ggplot(subset(dscr.fix.rpl, stat == "mean" & fix == "fixlat" & group == "free" & gazed %in% c("gaze", "nongaze")), aes(x= gazed, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.rpl, stat == "mean" & fix == "fixlat" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure - subset(dscr.fix.rpl, stat == "se" & fix == "fixlat" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure,
    ymax=subset(dscr.fix.rpl, stat == "mean" & fix == "fixlat" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure + subset(dscr.fix.rpl, stat == "se" & fix == "fixlat" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure),
    width=.2,
    position=position_dodge(.9)) +
  expand_limits(y=c(0,4000))

#plot.fixlat.rpl


plot.fixlat.zwckl <- ggplot(subset(dscr.fix.zwckl, stat == "mean" & fix == "fixlat"), aes(x = gazed, y=measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.zwckl, stat == "mean" & fix == "fixlat")$measure - subset(dscr.fix.zwckl, stat == "se" & fix == "fixlat")$measure,
    ymax=subset(dscr.fix.zwckl, stat == "mean" & fix == "fixlat")$measure + subset(dscr.fix.zwckl, stat == "se" & fix == "fixlat")$measure),
    width=.2,
    position = position_dodge(.9))  +
  expand_limits(y=c(0,4000))

#plot.fixlat.zwckl

```

```{r plots fix rpl-zwckl, include=FALSE}

plot.fix.rpl <- ggplot(subset(dscr.fix.rpl, stat == "mean" & fix == "fix" & group == "free" & gazed %in% c("gaze", "nongaze")), aes(x= gazed, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.rpl, stat == "mean" & fix == "fix" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure - subset(dscr.fix.rpl, stat == "se" & fix == "fix" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure,
    ymax=subset(dscr.fix.rpl, stat == "mean" & fix == "fix" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure + subset(dscr.fix.rpl, stat == "se" & fix == "fix" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure),
    width=.2,
    position=position_dodge(.9)) +
  expand_limits(y=c(0,0.15))

#plot.fix.rpl


plot.fix.zwckl <- ggplot(subset(dscr.fix.zwckl, stat == "mean" & fix == "fix"), aes(x = gazed, y=measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.zwckl, stat == "mean" & fix == "fix")$measure - subset(dscr.fix.zwckl, stat == "se" & fix == "fix")$measure,
    ymax=subset(dscr.fix.zwckl, stat == "mean" & fix == "fix")$measure + subset(dscr.fix.zwckl, stat == "se" & fix == "fix")$measure),
    width=.2,
    position = position_dodge(.9))  +
  expand_limits(y=c(0,0.15))

#plot.fix.zwckl

```

```{r plots fixn rpl-zwckl, include=FALSE}


plot.fixn.rpl <- ggplot(subset(dscr.fix.rpl, stat == "mean" & fix == "fixn" & group == "free" & gazed %in% c("gaze", "nongaze")), aes(x= gazed, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.rpl, stat == "mean" & fix == "fixn" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure - subset(dscr.fix.rpl, stat == "se" & fix == "fixn" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure,
    ymax=subset(dscr.fix.rpl, stat == "mean" & fix == "fixn" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure + subset(dscr.fix.rpl, stat == "se" & fix == "fixn" & group == "free" & gazed %in% c("gaze", "nongaze"))$measure),
    width=.2,
    position=position_dodge(.9)) #+
  #expand_limits(y=c(0,0.15))

#plot.fixn.rpl


plot.fixn.zwckl <- ggplot(subset(dscr.fix.zwckl, stat == "mean" & fix == "fixn"), aes(x = gazed, y=measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.zwckl, stat == "mean" & fix == "fixn")$measure - subset(dscr.fix.zwckl, stat == "se" & fix == "fixn")$measure,
    ymax=subset(dscr.fix.zwckl, stat == "mean" & fix == "fixn")$measure + subset(dscr.fix.zwckl, stat == "se" & fix == "fixn")$measure),
    width=.2,
    position = position_dodge(.9))  #+
  #expand_limits(y=c(0,0.15))

#plot.fixn.zwckl

```

<!-- UNTERSCHIEDE -->
```{r plots saccade free-mem, include=FALSE}

plot.sac.freemem <- ggplot(subset(dscr.sac.rpl, stat == "mean" & area == "f"), aes(x= group, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values=c("#00BFC4", "#C77CFF")) +
  geom_errorbar(aes(
    ymin=subset(dscr.sac.rpl, stat == "mean" & area == "f")$measure - subset(dscr.sac.rpl, stat == "se" & area == "f" & group == "free")$measure,
    ymax=subset(dscr.sac.rpl, stat == "mean" & area == "f")$measure + subset(dscr.sac.rpl, stat == "se" & area == "f" & group == "free")$measure),
    width=.2,
    position=position_dodge(.9))

#plot.sac.freemem

```

```{r plots fixlat free-mem, include=FALSE}

plot.fixlat.freemem <- ggplot(subset(dscr.fix.rpl, stat == "mean" & fix == "fixlat"), aes(x= group, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.rpl, stat == "mean" & fix == "fixlat")$measure - subset(dscr.fix.rpl, stat == "se" & fix == "fixlat")$measure,
    ymax=subset(dscr.fix.rpl, stat == "mean" & fix == "fixlat")$measure + subset(dscr.fix.rpl, stat == "se" & fix == "fixlat")$measure),
    width=.2,
    position=position_dodge(.9))

#plot.fixlat.freemem

```

```{r plots fix free-mem, include=FALSE}

plot.fix.freemem <- ggplot(subset(dscr.fix.rpl, stat == "mean" & fix == "fix"), aes(x= group, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.rpl, stat == "mean" & fix == "fix")$measure - subset(dscr.fix.rpl, stat == "se" & fix == "fix")$measure,
    ymax=subset(dscr.fix.rpl, stat == "mean" & fix == "fix")$measure + subset(dscr.fix.rpl, stat == "se" & fix == "fix")$measure),
    width=.2,
    position=position_dodge(.9))

#plot.fix.freemem

```

```{r plots fixn free-mem, include=FALSE}

plot.fixn.freemem <- ggplot(subset(dscr.fix.rpl, stat == "mean" & fix == "fixn"), aes(x= group, y= measure, fill = gazed)) +
  geom_col(position = "dodge") +
  geom_errorbar(aes(
    ymin=subset(dscr.fix.rpl, stat == "mean" & fix == "fixn")$measure - subset(dscr.fix.rpl, stat == "se" & fix == "fixn")$measure,
    ymax=subset(dscr.fix.rpl, stat == "mean" & fix == "fixn")$measure + subset(dscr.fix.rpl, stat == "se" & fix == "fixn")$measure),
    width=.2,
    position=position_dodge(.9))

plot.fixn.freemem

```

```{r Anova saccades, warning=FALSE, message=FALSE, include=FALSE}
# ANOVA Saccades
## 2 (Group) x 2 (Gaze) ANOVA

icond <- gl(2,1,labels=c("cued","uncued")) # within-factor
idata <- data.frame(icond)

for (st in 17:19) {
  carmod <- lm(as.matrix(df.w.et[,c(st,(st+3))]) ~ df.w.et$group)
  #print(colnames(df.w.et[,c(st,(st+3))]))
  #print(Anova(carmod, idata=idata, idesign=~icond, type="III"))
  assign(paste0("anova.",colnames(df.w.et)[st]), Anova(carmod, idata=idata, idesign=~icond, type="III"))
  assign(paste0("apa.anova.",colnames(df.w.et)[st]), apa_print(Anova(carmod, idata=idata, idesign=~icond, type="III"), correction="GG", mse = FALSE))
  }



rm(carmod, idata, icond, st)



```

```{r Anova fixations joint, warning = FALSE, message = FALSE, include=FALSE}

# ANOVA Fixations characteristics for joint attention
## 2 (Group) x 2 (Gaze) ANOVA

icond <- gl(2,1,labels=c("cued","uncued")) # within-factor
idata <- data.frame(icond)

for (st in seq(7,16,4)) { # Variables 7:16, every 4th: fix.gaze and fix.nogaze; fixn.gaze and ...
  carmod <- lm(as.matrix(df.w.et[,st:(st+1)]) ~ df.w.et$group)
  #print(colnames(df.w.et[,st:(st+1)]))
  #print(Anova(carmod, idata=idata, idesign=~icond, type="III"))
  assign(paste0("anova.",colnames(df.w.et)[st]), Anova(carmod, idata=idata, idesign=~icond, type="III"))
  assign(paste0("apa.anova.",colnames(df.w.et)[st]), apa_print(Anova(carmod, idata=idata, idesign=~icond, type="III"), correction="GG", mse = FALSE))
  }

rm(carmod, idata, icond, st)

```

```{r Anova fixations social, warning = FALSE, message = FALSE, echo= FALSE}
# ANOVA Fixations characteristics
## 2 (Group) x 2 (Face/Body) ANOVA

icond <- gl(2,1,labels=c("head","body")) # within-factor
idata <- data.frame(icond)

for (st in seq(5,16,4)) { # Variables 5:16, every 4th: fix.face and fix.noface; fixn.face and ...
    carmod <- lm(as.matrix(df.w.et[,st:(st+1)]) ~ df.w.et$group)
  #print(Anova(carmod, idata=idata, idesign=~icond, type="III"))
  assign(paste0("anova.",colnames(df.w.et)[st]), Anova(carmod, idata=idata, idesign=~icond, type="III"))
  assign(paste0("apa.anova.",colnames(df.w.et)[st]), apa_print(Anova(carmod, idata=idata, idesign=~icond, type="III"), correction="GG", mse = FALSE))
  }


rm(carmod, idata, icond, st)

```

```{r Anova memory, warning=FALSE, message=FALSE, include=FALSE}
# Recalled items
# 2 (Condition) x 2 (Gaze) ANOVA (auf erinnerte Details)

imem <- gl(2,1,labels=c("cued","uncued"))
idata <- data.frame(imem)

# Car
carmod <- lm(as.matrix(df.w.mem[,3:4]) ~ df.w.mem$bed)
# print(colnames(df.w.mem[c(3,4)]))
#print(Anova(carmod, idata=idata, idesign=~imem, type="III"))
anova.mem <- Anova(carmod, idata=idata, idesign=~imem, type="III")
apa.anova.mem <- apa_print(Anova(carmod, idata=idata, idesign=~imem, type="III"), correction="GG", mse = FALSE)

dscr.mem <- df.w.mem %>% summarise(mean(memgaze), sd(memgaze), mean(memnogaze), sd(memnogaze))
dscr.mem.group <- df.w.mem %>% group_by(bed) %>% summarise(mean(memgaze), sd(memgaze), mean(memnogaze), sd(memnogaze))

rm(imem, idata, carmod)
```

to-do (für euch :-) )

---

class: inverse, center, middle

# Grundlagen

---

## Relevance 

Humans in their social environment rely on the information other humans provide.

--

- explicit signals like in conversations

--

- **implicit signals like in gaze following**

--

Specifically, if an individual looks into a specific direction, this might be read as a signal

- redirects the observers attention towards the referred object or location

  - refered to as joint attention

---

## Gaze cuing

Most used paradigm to investigate these attentional shifts is the gaze-cuing paradigm (Frischen et al., 2007)
    
  - perceived gaze cues lead to a reflexive attentional shift
    
  - but lack ecological validity
      
      - recent study did not find reliable links between classical laboratory gaze cueing tasks and real social engage (Hayward et al., 2017)

--
        
Researches must be sensible to these differences when generalizing laboratory findings (Risko et al, 2012)

---

## Naturalistic scenarios

--

To account for the ecological validity of gaze cues Zwickel and Võ (2010) conducted a joint attention study with a more naturalistic scenario

---

background-image: url(2017_SFB_repl-zwickel-vo_files/stimuli-zwickel.png)
background-size: 100%

---

## Critique

- computer generated grayscaled stimuli, in contrast to their motivation to provide a naturalistic setup

- very little power in their study (n = 16)

--

This conceptual replication of Zwickel and Võ (2010) aims at answering multiple research questions regarding joint and social attention

--

1. the replication of Zwickel and Võ (2010) findings

--

2. extending this line of research
  
  - influence of top-down modulations on joint and social attention in naturalistic scenes
  
  - consequences for subsequent cognitive processes, here memory effects
  
---
class: inverse, center, middle

# Die Replikation

---

background-image: url(2017_SFB_repl-zwickel-vo_files/stimuli.png)
background-size: 94%

--

background-image: url(2017_SFB_repl-zwickel-vo_files/design.png)
background-size: 94%

---

## 1) Vergleich mit Zwickel and Võ (2010)

## 2) Unterschiede durch Instruktion

---

## 1. the replication of Zwickel and Võ (2010) findings

--

Vergleich der Bedingungen *free-encoding* mit Bedingung *Person*

--

- Abhängige Variablen
    - Sakkaden (Kopf → Objekt)
    - Fixationlatenz (gaze vs. non-gaze Object)
    - Fixationsdauer (gaze vs. non-gaze Object)
    - Fixationsanzahl (gaze vs. non-gaze Object)
---

#### Sakkaden

Anzahl an Sakkaden "Kopf → Objekt" / Alle Sakkaden "Kopf → " (in %)<br/><br/><br/>

.pull-left[

##### Replication:

```{r comparison saccades repl, echo=FALSE}
plot.sac.rpl
```

]

.pull-right[

##### Zwickel and Võ (2010):

```{r comparison saccades zwickel, echo=FALSE}
plot.sac.zwckl

```

]

---

#### Fixationslatenz

Dauer von Stimulus-onset bis erste Fixation (in ms)<br/><br/><br/>

.pull-left[

##### Replication:

```{r comparison fixlat repl, echo=FALSE}

plot.fixlat.rpl

```

]

.pull-right[

##### Zwickel and Võ (2010):

```{r comparison fixlat zwickel, echo=FALSE}

plot.fixlat.zwckl

```

]

---

#### Fixationsdauer

Kumulierte Zeit, wenn Fixation auf ROI / Kumulierte Zeit der Fixation der Szene (in %)<br/><br/>

.pull-left[

##### Replication:

```{r comparison fix repl, echo=FALSE}

plot.fix.rpl

```

]

.pull-right[

##### Zwickel and Võ (2010):

```{r comparison fix zwickel, echo=FALSE}

plot.fix.zwckl

```

]

---

#### Fixationsanzahl

.pull-left[

Anzahl der Fixationen pro ROI / Alle Fixationen der Szene (in %)
<br><br>

##### Replication:

```{r comparison fixn repl, echo=FALSE}

plot.fixn.rpl

```

]

.pull-right[

"[...] size-normalized by multiplying them with the total area of the scene divided by the area of the object"

##### Zwickel and Võ (2010):

```{r comparison fixn zwickel, echo=FALSE}

plot.fixn.zwckl

```

]

---

## 2. extending this line of research

- Einfluss der Person top-down modulierbar?

  - Unterschiede joint attention vs. social attention?
    
        - *joint attention:* Einfluss auf das Blickverhalten bezüglich der Objekte (gaze vs. non-gaze)?
        
        - *social attention:* Einfluss auf das Blickverhalten bezüglich der Person (Kopf vs. Körper)?

- Konsequenzen für nachfolgende kognitive Prozesse?

  - Einfluss auf die Gedächtnisleistung?
  
  
--
      - Spoiler:
      
          - Effekt nur für *free vs. mem* <font size="-1">[ `r apa.anova.mem$full_result$df_w_mem_bed `]</font>
          
          - kein Effekt für *gazed* <font size="-1">[ `r apa.anova.mem$full_result$imem `]</font>
          
          - keine Interaktion <font size="-1">[ `r apa.anova.mem$full_result$df_w_mem_bed_imem `]</font>

---

#### Sakkaden

Anzahl an Sakkaden "Kopf → Objekt" / Alle Sakkaden "Kopf → " (in %)<br><br>

.pull-left[

```{r comparison saccades free, echo=FALSE}
plot.sac.freemem
```

]

--

.pull-right[

##### joint attention:

_free vs. mem:_<br>
`r apa.anova.sac.fgaze$full_result$df_w_et_group `

_ROIs:_<br>
`r apa.anova.sac.fgaze$full_result$icond `

_interaction:_<br>
`r apa.anova.sac.fgaze$full_result$df_w_et_group_icond `

]

--

______________

*Fazit:* Verstärkt Sakkaden vom Kopf zu den Objekten, wenn explizites Encoding der Szene & wenn Objekt gecued wird!

---

#### Fixationslatenz

Dauer von Stimulus-onset bis erste Fixation (in ms)<br><br>

.pull-left[

```{r comparison fixlat free, echo=FALSE}

plot.fixlat.freemem

```

]

--

.pull-right[

.pull-left[

##### joint attention:
_free vs. mem:_<br>
`r apa.anova.fixlat.gaze$full_result$df_w_et_group `

_ROIs:_<br>
`r apa.anova.fixlat.gaze$full_result$icond `

_interaction:_<br>
`r apa.anova.fixlat.gaze$full_result$df_w_et_group_icond `

]

.pull-right[

##### social attention:<br>
<br>
`r apa.anova.fixlat.face$full_result$df_w_et_group `
<br><br><br>
`r apa.anova.fixlat.face$full_result$icond `
<br><br><br>
`r apa.anova.fixlat.face$full_result$df_w_et_group_icond `

]

]

--

______________

*Fazit:* Top-Down-Modulation keinen Einfluss auf social attention; aber auf joint attention.

---

#### Fixationsdauer

Kumulierte Zeit, wenn Fixation auf ROI / Kumulierte Zeit der Fixation der Szene (in %)

.pull-left[

```{r comparison fix free, echo=FALSE}
plot.fix.freemem
```

]

--

.pull-right[

.pull-left[

##### joint attention:
_free vs. mem:_<br>
`r apa.anova.fix.gaze$full_result$df_w_et_group `

_ROIs:_<br>
`r apa.anova.fix.gaze$full_result$icond `

_interaction:_<br>
`r apa.anova.fix.gaze$full_result$df_w_et_group_icond `

]

.pull-right[

##### social attention:<br>
<br>
`r apa.anova.fix.face$full_result$df_w_et_group `
<br><br><br>
`r apa.anova.fix.face$full_result$icond `
<br><br><br>
`r apa.anova.fix.face$full_result$df_w_et_group_icond `

]

]

--

______________

*Fazit:* Top-Down-Modulation keinen Einfluss auf social attention; aber auf joint attention.

---

#### Fixationsanzahl

Anzahl der Fixationen pro ROI / Alle Fixationen der Szene (in %)<br><br>

.pull-left[

```{r comparison fixn free, echo=FALSE}

plot.fixn.freemem

```

]

--

.pull-right[

.pull-left[

##### joint attention:
_free vs. mem:_<br>
`r apa.anova.fixn.gaze$full_result$df_w_et_group `

_ROIs:_<br>
`r apa.anova.fixn.gaze$full_result$icond `

_interaction:_<br>
`r apa.anova.fixn.gaze$full_result$df_w_et_group_icond `

]

.pull-right[

##### social attention:<br>
<br>
`r apa.anova.fixn.face$full_result$df_w_et_group `
<br><br><br>
`r apa.anova.fixn.face$full_result$icond `
<br><br><br>
`r apa.anova.fixn.face$full_result$df_w_et_group_icond `

]

]

--

______________

*Fazit:* Top-Down-Modulation keinen Einfluss auf social attention; aber auf joint attention.

---
class: inverse, center, middle

# Diskussion

---

## Schlussfolgerung

- erfolgreiche Replikation

  - Alle Effekte der Person-Bedingung von Zwickel and Võ (2010) wurden repliziert
  
--
  
  - insgesamt stärkere und klarere Effekte (idR kleinere *SE*, und größere *ΔM*'s)
      - zurückzuführen auf naturalistischere Szenen! (?)
      
      - Quantifizierbar?

--

- Einfluss der Top-Down-Modulation


--
  - kaum auf genuin soziale Reize (Kopf, Körper) → kein Einfluss auf *social attention* 
    
--

  - aber deutlich auf künstliche soziale Reize (falls Objekt gecued wird) → Einfluss auf *joint attention*
    
---

class: inverse, center, middle

# Vielen Dank für Eure Aufmerksamkeit!

# :-)
      